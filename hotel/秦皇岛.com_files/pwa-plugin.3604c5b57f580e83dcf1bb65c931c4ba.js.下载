var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__publicField=(e,t,r)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),r);!function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={CHROMES:["chrome","crios"],PADS:["ipad","playbook","tablet"],BOTS:["bot","crawler","spider","feed","scraper","80legs","abachobot","accoona-ai-agent","addsugarspiderbot","adidxbot","adsbot-google","amznkassocbot","anyapexbot","aolbuild","applebot","arachmo","b-l-i-t-z-b-o-t","google-extended","google-inspectiontool","google-safety","apis-google","becomebot","beslistbot","billybobbot","bimbot","bingbot","bingpreview","bitlybot","blitzbot","boitho.com-dc","boitho.com-robot","btbot","catchbot","cerberian drtrs","chrome-lighthouse","charlotte","converacrawler","cosmos","covario ids","dataparksearch","developers.google.com/+/web/snippet","diamondbot","discobot","docomo","dotbot","duckduckbot","duckduckgo","earthcom.info","emeraldshield.com webbot","envolk[its]spider","esperanzabot","exabot","facebookexternalhit","facebot","fast enterprise crawler","fast-webcrawler","fdse robot","findlinks","flipboard","furlbot","fyberspider","g2crawler","gaisbot","galaxybot","geniebot","gigabot","girafabot","googlebot","google page speed insights","grapeshot","gurujibot","happyfunbot","hl_ftien_spider","holmes","htdig","iaskspider","ia_archiver","iccrawler","ichiro","igdespyder","irlbot","issuecrawler","jaxified bot","jyxobot","koepabot","l.webis","lapozzbot","larbin","ldspider","lexxebot","linguee bot","linkedinbot","linkwalker","light-house","lmspider","lwp-trivial","mabontland","magpie-crawler","mediapartners-google","mj12bot","mlbot","mnogosearch","mogimogi","mojeekbot","moreoverbot","morning paper","msnbot","msrbot","msr-isrccrawler","mvaclient","mxbot","netresearchserver","netseer crawler","newsgator","ng-search","nicebot","noxtrumbot","nusearch spider","nutchcvs","nymesis","obot","oegp","omgilibot","omniexplorer_bot","oozbot","orbiter","outbrain","pagebiteshyperbot","peew","pinterest","polybot","pompos","postpost","psbot","pycurl","qseero","radian6","rampybot","redditbot","rufusbot","sandcrawler","sbider","scoutjet","scrubby","searchsight","seekbot","semanticdiscovery","sensis web crawler","seochat::bot","seznambot","shim-crawler","shopwiki","shoula robot","silk","sitebot","slackbot","slurp","snappy","sogou spider","sosospider","speedy spider","sqworm","stackrambler","structured-data","suggybot","surveybot","synoobot","teoma","terrawizbot","thesubot","thumbnail.cz robot","tineye","truwogps","tumblr","turnitinbot","tweetedtimes bot","twengabot","twitterbot","updated","urlfilebot","vagabondo","voilabot","vortex","voyager","vyu2","whatsapp","webcollage","websquash.com","wf84","wofindeich robot","womlpefactory","xaldon_webspider","yacy","yahooseeker","yahooseeker-testing","yandex","yasaklibot","yeti","yodaobot","yooglifetchagent","youdaobot","zao","zealbot","zspider","zyborg","thunderbird","abilogicbot","link valet","link validity check","linkexaminer","linksmanager.com_bot","mojoo robot","notifixious","online link validator","ploetz + zeller","reciprocal link system pro","rel link checker lite","sitebar","vivante link checker","w3c-checklink","xenu link sleuth","emailsiphon","cse html validator","csscheck","cynthia","htmlparser","p3p validator","w3c_css_validator_jfouffa","w3c_validator","wdg_validator","awasu","bloglines","everyfeed-spider","feedfetcher-google","greatnews","gregarius","magpierss","nfreader","universalfeedparser","binget","curl","java","libwww-perl","microsoft url control","peach","php","pxyscand","pycurl","python-urllib","appengine-google","!susie","amaya","cocoal.icio.us","domainsdb.net metacrawler","gpodder","gsitecrawler","itunes","lftp","metauri","mt-newswatcher","nitro pdf","snoopy","urd-magpie","webcapture","windows-media-player","googleother"],BOTS_WHITE_LIST:["safeAreaBottom"],MOBILES:["mobile","iphone","android","phone","wap","opera","opera mini","ucweb","windows ce","symbian","series","webos","sony","blackberry","dopod","nokia","samsung","palmsource","meizu","midp","cldc","motorola"],SAFARI:["safari"],LIGHTHOUSE:["google page speed insights","chrome-lighthouse","light-house"]};const r=(e,t,o)=>{const n=e.replace(t,o);return-1!==n.indexOf(t)?r(n,t,o):n};var o={replaceAll:r};const{MOBILES:n,BOTS:i,BOTS_WHITE_LIST:a,PADS:s,CHROMES:c,SAFARI:u,LIGHTHOUSE:l}=t,{replaceAll:d}=o;const p=new function(){this.uaParser=e=>e&&e.toString(),this.isEDG=e=>{const t=this.uaParser(e);if(!t)return!1;return!(-1===t.toLowerCase().indexOf("edg"))},this.isChrome=e=>{const t=this.uaParser(e);if(!t)return!1;const r=t.toLowerCase();return c.some((e=>-1!==r.indexOf(e)))&&!this.isEDG(t)},this.isSafari=e=>{const t=this.uaParser(e);if(!t)return!1;const r=t.toLowerCase();return u.some((e=>-1!==r.indexOf(e)))&&!this.isChrome(t)&&!this.isEDG(t)},this.isLightHouse=e=>{const t=this.uaParser(e);if(!t)return!1;const r=t.toLowerCase();return l.some((e=>-1!==r.indexOf(e)))},this.isPad=e=>{const t=this.uaParser(e);if(!t)return!1;const r=t.toLowerCase(),o=s.some((e=>-1!==r.indexOf(e))),n=/android/.test(r)&&!/mobile/.test(r);return o||n},this.isMobile=e=>{const t=this.uaParser(e);if(!t)return!1;const r=t.toLowerCase();return n.some((e=>-1!==r.indexOf(e)))},this.isBot=e=>{let t=this.uaParser(e);if(!t)return!1;a.forEach((e=>{t=t.replaceAll?t.replaceAll(e,""):d(t,e,"")}));const r=t.toLowerCase();return i.some((e=>-1!==r.indexOf(e)))},this.isIOS=e=>{const t=this.uaParser(e);return!!t&&/ip(?:hone|od)/i.test(t)},this.isAndroid=e=>{const t=this.uaParser(e);return!!t&&/android/i.test(t)},this.browserType=e=>{const t=this.uaParser(e);if(t){if(this.isChrome(t))return"CHROMES";if(this.isSafari(t))return"SAFARI";if(this.isEDG(t))return"EDGE"}return"ELSE"},this.clientType=e=>{const t=this.uaParser(e);return t&&this.isMobile(t)&&!this.isPad(t)?"H5":"ONLINE"}};if("undefined"!=typeof process&&null!==process.versions&&null!==process.versions.node)p.uaParser=function(e){if(e)if("object"==typeof e&&e.headers){const t=[];if(Object.entries(e.headers).forEach((([e,r])=>{/^(User-Agent|Sec-CH-UA)/i.test(e)&&t.push(r)})),t.length)return t.join(" ")}else if("string"==typeof e)return e};else{let e=function(e){const t=new Map([["0.3.0","6.3"],["0.2.0","6.2"],["0.1.0","6.1"]]);return t.has(e)?t.get(e):"10.0"};const t=e=>{let t="";return"64"===e.bitness?"x86"===e.architecture?t="x86_64":"arm"===e.architecture&&(t="aarch64"):"arm"===e.architecture&&"32"===e.bitness&&(t="armv7l"),""===t?`X11; CrOS ${e.platformVersion}`:`X11; CrOS ${t} ${e.platformVersion}`},r=t=>{let r="";return"x86"===t.architecture&&"64"===t.bitness?r="; Win64; x64":"arm"===t.architecture?r="; ARM":!0===t.wow64&&(r="; WOW64"),`Windows NT ${e(t.platformVersion)}${r}`},o=e=>{let t="Macintosh; Intel Mac OS X ",r=e.platformVersion;return r.indexOf(".")>-1&&(r=r.split(".").join("_")),t+=r,t},n=e=>{let t="Linux; Android ";return t+=e.platformVersion,e.model&&(t+="; ",t+=e.model),t},i=function(e,i){if(!e)return i;const a={architecture:e.architecture||"x86",bitness:e.bitness||"64",model:e.model||"",platform:e.platform||"Windows",platformVersion:e.platformVersion||"10.0",wow64:e.wow64||!1,mobile:e.wow64||!1,brands:e.brands||[]};let s=`${i||""} Mozilla/5.0 (`;return["Chrome OS","Chromium OS"].includes(a.platform)?s+=t(a):s+="Windows"===a.platform?r(a):"macOS"===a.platform?o(a):"Android"===a.platform?n(a):"X11; Linux x86_64",s+=") AppleWebKit/537.36 (KHTML, like Gecko) Chrome/",a.mobile&&(s+=" Mobile"),s+=" Safari/537.36",s};p.uaParser=function(e){if(e){if("string"==typeof e)return e;if("object"==typeof e)return i(e)}return i(window.navigator.userAgentData,window.navigator.userAgent)}}const f=e=>!(!e||!e.includes("/m/sw.js")),b=()=>"undefined"!=typeof window&&"undefined"!=typeof document,h=()=>b()&&"serviceWorker"in window.navigator&&"undefined"!=typeof caches&&(!!window.navigator.standalone||!!window.matchMedia("(display-mode: standalone)").matches||!!window.matchMedia("(display-mode: minimal-ui)").matches);var m={HTML_DATA_ATTRIBUTE_NAME:"data-cargo",H5:"h5",ONLINE:"online",PADS:["ipad","playbook","tablet"],MOBILES:["mobile","iphone","android","phone","wap","opera","opera mini","ucweb","windows ce","symbian","series","webos","sony","blackberry","dopod","nokia","samsung","palmsource","meizu","midp","cldc","motorola"],ENV_LIST:[{value:"sandbox",keywords:["sandbox"]},{value:"fws",keywords:["fws","fat","dev"]},{value:"uat",keywords:["uat"]},{value:"lpt",keywords:["lpt"]}]},w="locale",g="language",_="currency",y="site",v="group",O="measurement",A="temperature",E="hourclock",L="contextType",x=function(e){var t={};return(window.document.getElementsByTagName("html")[0].getAttribute(m.HTML_DATA_ATTRIBUTE_NAME)||"").split(",").forEach((function(e){var r=e.split(":");2===r.length&&(t[r[0]]=r[1])})),e?t[e]||"":t},S=function(e,t){if(e&&t){var r=x();r[e]=t,window.document.getElementsByTagName("html")[0].setAttribute(m.HTML_DATA_ATTRIBUTE_NAME,Object.entries(r).map((function(e){return e.join(":")})).join())}},C=function(e){var t="";return e&&(t="; ".concat(window.document.cookie).split("; ".concat(e,"=")).pop().split(";")[0]),t},T=function(e){var t,r=e||x(L);return r?r.toLowerCase()===m.H5:((t=(window.navigator.userAgent||"").toLowerCase())?!m.MOBILES.some((function(e){return-1!==t.indexOf(e)}))||m.PADS.some((function(e){return-1!==t.indexOf(e)}))||/android/.test(t)&&!/mobile/.test(t)?m.ONLINE:m.H5:m.ONLINE)===m.H5||"m"===window.location.pathname.split("/")[1]},k=function(e){if(/^[a-z]{2}(-|_)[a-z]{2}$/i.test(e)){var t=e.match(/[a-z]{2}/gi);return"".concat(t[0].toLowerCase(),"-").concat(t[1].toUpperCase())}},P={getLocale:function(e,t){var r=k(x(w));return r||t||(r=k(window.document.getElementsByTagName("html")[0].getAttribute("lang"))),r||(r=T(e)?k(C("ibu_h5_local")):k(C("ibulocale")||C("ibu_h5_local"))),r||""},setLocale:function(e){var t=k(e);t&&S(w,t)},getLanguage:function(e){var t=x(g);return t||(t=T(e)?C("ibu_h5_lang"):C("ibulanguage")),(t||"").toLowerCase()},setLanguage:function(e){e&&/^([a-z]{2}){1,2}$/i.test(e)&&S(g,e.toLowerCase())},getCurrency:function(e){var t=x(_);return t||(t=T(e)&&C("ibu_h5_curr")||C("cookiePricesDisplayed")),(t||"").toUpperCase()},setCurrency:function(e){e&&/^[a-z]{3}$/i.test(e)&&S(_,e.toUpperCase())},getSite:function(){var e=x(y);return e||(e=C("ibu_h5_site")),(e||"").toUpperCase()},setSite:function(e){e&&/^[a-z]{2}$/i.test(e)&&S(y,e.toUpperCase())},getGroup:function(){var e=x(v);return e||(e=C("ibu_h5_group")),e||""},setGroup:function(e){e&&S(v,e)},getMeasurement:function(){var e=x(O);return e||(e=C("ibu_measurement")),e||""},setMeasurement:function(e){S(O,e)},getTemperature:function(){var e=x(A);return e||(e=C("ibu_temperature")),e||""},setTemperature:function(e){S(A,e)},getHourClock:function(){var e=x(E);return e||(e=C("ibu_hourclock")),e||""},setHourClock:function(e){S(E,e)},getContextType:function(){return T()?m.H5:m.ONLINE},setContextType:function(e){e&&[m.H5,m.ONLINE].includes(e.toLowerCase())&&S(L,e.toLowerCase())},getEnv:function(){var e="prod",t=window.location.hostname||window.location.host;return m.ENV_LIST.forEach((function(r){if(r.keywords.forEach((function(o){if(t.indexOf(o)>-1)return e=r.value,!0})),e)return!0})),e}};"undefined"!=typeof window&&(window.cargo=P);const j=e(P);function M(e){var t=e||{},r=t.isOnline,o=t.isH5,n=r?"online":o?"h5":void 0;return j.getLocale(n)}function I(e){var t=e||{},r=t.isOnline,o=t.isH5,n=r?"online":o?"h5":void 0;return j.getCurrency(n)}var N=function(){return function(e){if("undefined"==typeof document)return"";var t=document.cookie,r=new RegExp("".concat(e,"=([^;]+);?")),o=t.match(r);return o?o[1]:""}("_bfa").split(".").slice(1,3).join(".")},B={},U={};Object.defineProperty(U,"__esModule",{value:!0}),U.LOCALE_MAP_SITE=void 0;U.LOCALE_MAP_SITE={en_us:"EN",en_xx:"EN",ar_xx:"AR"};var H={};function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(o=i.call(r)).done)&&(s.push(o.value),s.length!==t);c=!0);}catch(e){u=!0,n=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw n}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function z(e){return"[object Array]"===Object.prototype.toString.call(e)}Object.defineProperty(H,"__esModule",{value:!0}),H.buildQuery=void 0,H.parseQuery=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:decodeURIComponent;if("string"!=typeof e)return{};var o={};return e.split("&").forEach((function(e){var n=R(e.split("="),2),i=n[0],a=n[1];if(i){var s=D(a,r),c=o[i];c&&!t?z(c)?c.push(s):o[i]=[c,s]:o[i]=s}})),o};function D(e,t){if(!e)return"";try{return t(e)}catch(t){return e}}H.buildQuery=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:encodeURIComponent,o=[];for(var n in e)if(Object.hasOwnProperty.call(e,n)){var i=e[n];if(t&&null==i)continue;"function"==typeof i?i=i():null===i&&(i=""),o.push("".concat(n,"=").concat(r(void 0===i?"":String(i))))}return o.join("&")},Object.defineProperty(B,"__esModule",{value:!0});var F=B.formatLocale=q;B.formatTripEnv=function(e){switch(e){case"dev":case"fat":case"fws":return"fws";case"lpt":return"lpt";case"uat":return"uat";default:return"prod"}},B.formatUrlWithTripContext=function(e,t,r){if(!e)return"";if("string"!=typeof e)return console.error("[TripComponent]: (formatUrlWithTripContext) error: the type of url is invalid!"),"";var o,n,i="",a=e;if(e.indexOf("#")>-1){var s=G(a.split("#"),2);a=s[0],i=s[1]}var c=G(a.split("?"),2);if(o=c[0],n=c[1],!o)return e;try{var u=(r||{}).isCover,l=t.locale,d=t.currency,p=(n?(0,V.parseQuery)(n,!0):{})||{},f=l,b=d;return u||(f=p.locale||l,b=p.curr||p.currency||d),p.locale=f,p.curr=b,delete p.currency,"".concat(o||"","?").concat((0,V.buildQuery)(p)).concat(i?"#".concat(i):"")}catch(t){return console.error("[TripComponent]: (formatUrlWithTripContext) error: "),console.error(t),e}},B.getLangFromLocale=function(e){return q(e,"aa-bb").split("-")[0]},B.getRuntimeType=function(){var e="undefined"!=typeof window;return{type:e?"browser":"node",isBrowser:e,isNode:!e}},B.getSiteByLocale=function(e){var t=q(e,"aa_bb");return $.LOCALE_MAP_SITE[t]||t.split("_")[1].toUpperCase()};var $=U,V=H;function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(o=i.call(r)).done)&&(s.push(o.value),s.length!==t);c=!0);}catch(e){u=!0,n=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw n}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function X(e,t){return e.indexOf(t)>-1}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"aa-BB",r=X(e,"-")?"-":"_",o=e.split(r),n=G(o,2),i=n[0],a=void 0===i?"en":i,s=n[1],c=void 0===s?"US":s;return t.replace("aa",a.toLowerCase()).replace("AA",a.toUpperCase()).replace("bb",c.toLowerCase()).replace("BB",c.toUpperCase())}var K=function(){if("undefined"==typeof window)return!1;var e=window.location.pathname;return/^\/m/.test(e)||function(){if("undefined"==typeof navigator)return!1;var e=navigator.userAgent.toLowerCase();return/(ctrip|android|iphone|mobile|webos)/.test(e)&&!/(ipad|pad)/.test(e)}()};function Y(e){var t=void 0===e?{}:e,r=t.isOnline,o=void 0===r?!K():r,n=t.isDomestic,i=void 0===n?"ctrip"===function(){if("undefined"==typeof window)return"trip";var e,t=window.location.hostname||window.location.host;return e="ctrip",t.indexOf(e)>-1?"ctrip":"trip"}():n;return o?i?"//webresource.c-ctrip.com/code/ubt/_bfa.min.js":"//webresource.tripcdn.com/ares2/sysdev/ubt/*/default/_bfa.min.js":i?"//webresource.c-ctrip.com/code/ubt/_mubt.min.js":"//webresource.tripcdn.com/ares2/sysdev/ubt/*/default/_mubt.min.js"}function J(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var r=e[t],o=r.src;if(o&&(o.indexOf("/code/ubt")>-1||o.indexOf("/sysdev/ubt")>-1||o.indexOf("/modules/ubt/trip")>-1))return r}return null}function Z(){return"undefined"!=typeof window&&(void 0!==window.$_bf||window.__bfi&&"function"==typeof window.__bfi.push&&window.__bfi.push!==Array.prototype.push||!!window.__BF_LOADING_FLAG__)}function ee(e){if(Z())return Promise.resolve();var t,r=J()||function(e){void 0===e&&(e=Y());var t=new Date,r="?v="+t.getFullYear()+t.getMonth()+"_"+t.getDate(),o=document.createElement("script");o.type="text/javascript",o.charset="utf-8",o.async=!0,o.src=e+r;var n=document.getElementsByTagName("script")[0];return n&&n.parentElement?n.parentElement.insertBefore(o,n):document.body.appendChild(o),o}(e);return t=r,new Promise((function(e,r){t.addEventListener("error",(function(e){console.warn("load ubt js fail",e),r(e)})),t.addEventListener("load",(function(){e()})),t.addEventListener("readystatechange",(function(){"loaded"!==t.readyState&&"complete"!==t.readyState||e()}))}))}var te=function(){"object"==typeof window&&window.__BF_CUSTOM_LOAD_FLAG__||(Z()||J()?te=function(){}:function(e){if("undefined"==typeof window)return Promise.resolve();if(window.__BF_LOAD_PROMISE__)return window.__BF_LOAD_PROMISE__;var t=ee(e);return window.__BF_LOAD_PROMISE__=t,t}().then((function(){te=function(){}})))};function re(e,t){var r=(te(),window.__bfi||(window.__bfi=[]),window.__bfi);t.unshift(e),r.push(t)}function oe(e,t){re("_devTrace",[e,t])}const ne=["tripqate.com","tripcorp.com","trip.com"],ie={debug:!1,proxyWindowOpen:!0,autoRejectSW:!1,autoRejectManifest:!1,swEnable:!0,manifestPlaceholderId:"__pwa_manifest_inject__"},ae="ibu_pwa_hp_catch_err",se="ibu_pwa_hp_proxy_open_ok";class ce{constructor(e={}){var t;__publicField(this,"pluginVersion","1.0.2"),__publicField(this,"pluginName","pwa-header-plugin"),__publicField(this,"debug",!1),__publicField(this,"options",{}),__publicField(this,"logger",(t={prefix:`[${this.pluginName}]`,console:console,prefixColor:"#FCF2A1"},(e="",r={})=>{const{prefix:o,console:n,prefixColor:i="#3264ff"}=t,{type:a="info",assertion:s=!0,args:c=""}=r;s&&n&&n[a](`%c${o}: %c${e}.`,`color:${i}`,"color:#ccc",c)})),__publicField(this,"pageMeta",{}),this.options=__spreadValues(__spreadValues({},ie),e),this.debug=this.options.debug,this.pageMeta=this.getPageMeta(),this.attachContext()}attachContext(){window.__PWA_PLUGIN_CONTEXT__={version:this.pluginVersion,pageMeta:this.pageMeta}}getPageMeta(){const e=location.href,t=N(),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en_us";return M(arguments.length>1?arguments[1]:void 0)||e}(),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"USD";return I(arguments.length>1?arguments[1]:void 0)||e}();return{url:e,vid:t,locale:F(r),currency:o}}shouldOpenInPWA(e=""){var t;if(!e)return!1;if((e=>{if(!e)return!1;const t="string"==typeof e?e:e.href;return new RegExp("^(?:[a-z+]+:)?//","i").test(t)})(e)){const r=null!=(t=(e=>{try{const{hostname:t=""}=new URL(null!=e?e:window.location.href),r=t.split(".");return r.length>=2?r.slice(-2).join("."):null}catch(e){return null}})(e))?t:"";return ne.includes(r)&&h()}return!0}proxyOpenHandler(){const{proxyWindowOpen:e}=this.options;if(!e||!h())return this;const t=window.open,r=this;window.open=function(e,o,n){return r.shouldOpenInPWA(e)?(r.logger("Pwa navigation",{assertion:r.debug,args:{url:e,target:o}}),"_self"!==o&&oe(se,{link:e.toString(),target:null!=o?o:""}),t(e,"_self",n)):t(e,o,n),window}}initListeners(){window.navigator.serviceWorker&&window.navigator.serviceWorker.addEventListener("message",(e=>{var t;if(!(e=>{if(!e)return!1;const{source:t}=e;return!(!t||!f(t.scriptURL))})(e))return;const{type:r,payload:o}=e.data||{};if("TRACE_UBT"===r)if(window.UBT_API&&o){const e=null==(t=o.data)?void 0:t.data;e&&(e.etSource=this.pluginName);const{success:r}=window.UBT_API.push(o);r&&this.logger("Trace payload received from sw",{args:{evtPayload:o},assertion:this.debug})}})),window.addEventListener("pageshow",(()=>{(e=>{if(!b())return;if(window.__WB__)return window.__WB__.messageSW(e);const t=navigator.serviceWorker.controller;t&&f(t.scriptURL)&&new Promise((r=>{const o=new MessageChannel;o.port1.onmessage=e=>{r(e.data)},t.postMessage(e,[o.port2])}))})({type:"PWA_CLIENT_META_UPDATE",payload:__spreadValues({},this.pageMeta)})}),{once:!0})}run(){try{this.logger("plugin init",{assertion:this.debug,args:{options:this.options}}),this.proxyOpenHandler(),this.initListeners()}catch(e){const t=null==e?void 0:e.message;this.logger("catch error",{type:"error",args:{error:e,msg:t}}),oe(ae,{err:t})}}}if(b()){new ce({debug:!1,autoRejectSW:!1,autoRejectManifest:!1}).run()}}();
//# sourceMappingURL=https://sourcemap.ares.tripws.com/modules/ibu/online-assets/map/pwa-plugin.ceab25da61db4b40afe3bdab4b4a8ff2.map